<!-- Top Right Profile Control Component -->
<div class="profile-control-wrapper">
    <!-- Profile Avatar Button -->
    <button 
        id="profileAvatarBtn" 
        class="profile-avatar-btn"
        aria-haspopup="true"
        aria-expanded="false"
        aria-label="Open profile menu"
        title="Profile Menu"
    >
        <img 
            id="profileAvatarImg" 
            src="/uploads/avatars/default-avatar.svg" 
            alt="Profile Avatar" 
            class="profile-avatar-image"
            onerror="this.src='/assets/logo.svg'"
        />
        <span class="profile-status-indicator" aria-label="Online"></span>
    </button>

    <!-- Profile Dropdown Menu -->
    <div 
        id="profileDropdown" 
        class="profile-dropdown"
        role="menu"
        aria-labelledby="profileAvatarBtn"
        aria-hidden="true"
    >
        <!-- Profile Summary -->
        <div class="profile-dropdown-header">
            <img 
                id="dropdownAvatarImg" 
                src="/uploads/avatars/default-avatar.svg" 
                alt="Profile Avatar" 
                class="dropdown-avatar-image"
                onerror="this.src='/assets/logo.svg'"
            />
            <div class="profile-info">
                <h3 id="profileName" class="profile-name">Loading...</h3>
                <p id="profileRegNo" class="profile-reg-no">...</p>
            </div>
        </div>

        <div class="profile-dropdown-divider"></div>

        <!-- Profile Menu Items -->
        <nav class="profile-menu-items">
            <button 
                id="viewProfileBtn" 
                class="profile-menu-item"
                role="menuitem"
                tabindex="0"
            >
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                <span>View Profile</span>
            </button>

            <button 
                id="showIdCardBtn" 
                class="profile-menu-item"
                role="menuitem"
                tabindex="0"
            >
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="3" y="4" width="18" height="16" rx="2"/>
                    <path d="M7 8h10M7 12h6M7 16h4"/>
                </svg>
                <span>Show ID Card</span>
            </button>

            <label 
                for="changePhotoInput" 
                class="profile-menu-item profile-menu-label"
                role="menuitem"
                tabindex="0"
            >
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <path d="M21 15l-5-5L5 21"/>
                </svg>
                <span>Change Photo</span>
            </label>
            <input 
                type="file" 
                id="changePhotoInput" 
                accept="image/jpeg,image/jpg,image/png,image/webp,image/gif"
                style="display: none;"
                aria-label="Upload photo"
            />

            <button 
                id="settingsBtn" 
                class="profile-menu-item"
                role="menuitem"
                tabindex="0"
            >
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"/>
                </svg>
                <span>Settings</span>
            </button>

            <div class="profile-dropdown-divider"></div>

            <button 
                id="logoutBtn" 
                class="profile-menu-item profile-menu-item-danger"
                role="menuitem"
                tabindex="0"
            >
                <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                <span>Logout</span>
            </button>
        </nav>
    </div>
</div>

<!-- Profile Edit Side Panel -->
<div id="profileEditPanel" class="profile-edit-panel" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="profile-panel-overlay" aria-hidden="true"></div>
    <div class="profile-panel-content">
        <div class="profile-panel-header">
            <h2>Edit Profile</h2>
            <button 
                id="closePanelBtn" 
                class="profile-panel-close"
                aria-label="Close profile panel"
            >
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>

        <form id="profileEditForm" class="profile-edit-form">
            <div class="form-group">
                <label for="editName">Full Name</label>
                <input 
                    type="text" 
                    id="editName" 
                    name="name" 
                    required 
                    minlength="2"
                    placeholder="Enter your full name"
                />
            </div>

            <div class="form-group">
                <label for="editPhone">Phone Number</label>
                <input 
                    type="tel" 
                    id="editPhone" 
                    name="phone" 
                    placeholder="+91-9876543210"
                />
            </div>

            <div class="form-group">
                <label for="editDepartment">Department</label>
                <select id="editDepartment" name="department">
                    <option value="CSE">Computer Science & Engineering</option>
                    <option value="ECE">Electronics & Communication</option>
                    <option value="EEE">Electrical & Electronics</option>
                    <option value="ME">Mechanical Engineering</option>
                    <option value="CE">Civil Engineering</option>
                    <option value="IT">Information Technology</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="editYear">Year</label>
                    <select id="editYear" name="year">
                        <option value="1">1st Year</option>
                        <option value="2">2nd Year</option>
                        <option value="3">3rd Year</option>
                        <option value="4">4th Year</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="editSection">Section</label>
                    <select id="editSection" name="section">
                        <option value="A">Section A</option>
                        <option value="B">Section B</option>
                        <option value="C">Section C</option>
                        <option value="D">Section D</option>
                    </select>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" id="cancelEditBtn" class="btn btn-secondary">
                    Cancel
                </button>
                <button type="submit" id="saveProfileBtn" class="btn btn-primary">
                    <span class="btn-text">Save Changes</span>
                    <span class="btn-loader" style="display: none;">
                        <svg class="spinner" viewBox="0 0 50 50">
                            <circle cx="25" cy="25" r="20" fill="none" stroke="currentColor" stroke-width="4"/>
                        </svg>
                    </span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Upload Progress Indicator -->
<div id="uploadProgressContainer" class="upload-progress-container" style="display: none;">
    <div class="upload-progress-card">
        <div class="upload-progress-header">
            <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            <span id="uploadProgressText">Uploading photo...</span>
        </div>
        <div class="upload-progress-bar">
            <div id="uploadProgressFill" class="upload-progress-fill"></div>
        </div>
        <div id="uploadProgressPercent" class="upload-progress-percent">0%</div>
    </div>
</div>

<!-- Success Animation Container -->
<div id="successAnimationContainer" class="success-animation-container" style="display: none;">
    <div class="success-animation-content">
        <div class="success-checkmark">
            <svg viewBox="0 0 52 52">
                <circle class="success-checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
                <path class="success-checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
            </svg>
        </div>
        <p id="successMessage" class="success-message">Profile updated!</p>
    </div>
</div>
